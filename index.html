<!DOCTYPE html>
<html lang="zh-CN">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>二维码轮播</title>
    <style>
        body {
            margin: 0;
            padding: 0;
            display: flex;
            justify-content: center;
            align-items: center;
            min-height: 100vh;
            background-color: #f5f5f5;
            font-family: Arial, sans-serif;
        }
        
        .qr-container {
            text-align: center;
            background: white;
            padding: 20px;
            border-radius: 10px;
            box-shadow: 0 4px 8px rgba(0,0,0,0.1);
        }
        
        .qr-image {
            max-width: 300px;
            max-height: 300px;
            width: auto;
            height: auto;
            border: 2px solid #ddd;
            border-radius: 8px;
            transition: opacity 0.5s ease-in-out;
        }
        
        .qr-info {
            margin-top: 15px;
            font-size: 18px;
            color: #333;
        }
        
        .countdown {
            margin-top: 10px;
            font-size: 16px;
            color: #666;
        }
        
        .loading {
            color: #666;
            font-size: 16px;
        }
    </style>
</head>
<body>
    <div class="qr-container">
        <img id="qrImage" class="qr-image" alt="二维码" style="display: none;">
        <div id="loading" class="loading">加载中...</div>
        <div class="qr-info" id="qrInfo"></div>
        <div class="countdown" id="countdown"></div>
    </div>

    <script>
        class QRCarousel {
            constructor() {
                this.qrImages = [];
                this.currentIndex = 0;
                this.imageElement = document.getElementById('qrImage');
                this.infoElement = document.getElementById('qrInfo');
                this.countdownElement = document.getElementById('countdown');
                this.loadingElement = document.getElementById('loading');
                this.interval = null;
                this.countdownInterval = null;
                this.countdown = 10;
                
                this.init();
            }
            
            async init() {
                await this.loadImageList();
                if (this.qrImages.length > 0) {
                    this.showCurrentImage();
                    this.startCarousel();
                } else {
                    this.showError();
                }
            }
            
            async loadImageList() {
                // 常见的二维码图片格式
                const extensions = ['jpg', 'jpeg', 'png', 'gif', 'bmp', 'webp'];
                const imageFolder = './image/';
                
                // 这里假设您的二维码文件命名规则，可以根据实际情况调整
                const possibleNames = [
                    'qr1', 'qr2', 'qr3', 'qr4', 'qr5',
                    'qrcode1', 'qrcode2', 'qrcode3', 'qrcode4', 'qrcode5',
                    '1', '2', '3', '4', '5', '6', '7', '8', '9', '10'
                ];
                
                for (let name of possibleNames) {
                    for (let ext of extensions) {
                        const imagePath = `${imageFolder}${name}.${ext}`;
                        if (await this.imageExists(imagePath)) {
                            this.qrImages.push({
                                src: imagePath,
                                name: name
                            });
                        }
                    }
                }
            }
            
            imageExists(src) {
                return new Promise((resolve) => {
                    const img = new Image();
                    img.onload = () => resolve(true);
                    img.onerror = () => resolve(false);
                    img.src = src;
                });
            }
            
            showCurrentImage() {
                if (this.qrImages.length === 0) return;
                
                const currentImage = this.qrImages[this.currentIndex];
                this.imageElement.src = currentImage.src;
                this.imageElement.style.display = 'block';
                // this.infoElement.textContent = `${this.currentIndex + 1}/${this.qrImages.length}`;
                this.loadingElement.style.display = 'none';
                
                // 重置倒计时
                this.countdown = 10;
                this.updateCountdown();
            }
            
            updateCountdown() {
                this.countdownElement.textContent = ` ${this.countdown}s`;
            }
            
            startCountdown() {
                this.countdownInterval = setInterval(() => {
                    this.countdown--;
                    this.updateCountdown();
                    
                    if (this.countdown <= 0) {
                        this.countdown = 10;
                    }
                }, 1000);
            }
            
            stopCountdown() {
                if (this.countdownInterval) {
                    clearInterval(this.countdownInterval);
                    this.countdownInterval = null;
                }
            }
            
            nextImage() {
                this.currentIndex = (this.currentIndex + 1) % this.qrImages.length;
                this.showCurrentImage();
            }
            
            startCarousel() {
                // 开始倒计时
                this.startCountdown();
                
                // 每10秒切换一次
                this.interval = setInterval(() => {
                    this.nextImage();
                }, 10000);
            }
            
            stopCarousel() {
                if (this.interval) {
                    clearInterval(this.interval);
                    this.interval = null;
                }
                this.stopCountdown();
            }
            
            showError() {
                this.loadingElement.textContent = '未找到图片，请检查image文件夹';
                this.loadingElement.style.color = '#e74c3c';
            }
        }
        
        // 页面加载完成后启动轮播
        document.addEventListener('DOMContentLoaded', () => {
            new QRCarousel();
        });
        
        // 页面失去焦点时停止轮播，获得焦点时重新开始（可选功能）
        document.addEventListener('visibilitychange', () => {
            if (window.qrCarousel) {
                if (document.hidden) {
                    window.qrCarousel.stopCarousel();
                } else {
                    window.qrCarousel.startCarousel();
                }
            }
        });
    </script>
</body>
</html>
